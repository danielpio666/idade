<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<title>Calcular idade</title>
</head>

<body>
	<form name="teste" id="teste" method="post" action="">
    	Data de Nascimento : <input name="data" id="data" type="text" size="10" />
        <input type="button" name="bt_01" id="bt_01" value="Calcular" onClick="javascript:calcular_idade(document.getElementById('data').value);">
        Formato : dd/mm/aaaa
        <br><br>
        Idade : <input name="idade" id="idade" type="text" readonly size="3" /> Anos
    </form>
</body>
</html>

<script type="text/javascript">
document.getElementById('data').focus();

function calcular_idade(data){ 

    //calculo a data de hoje 
    hoje=new Date() 
    //alert(hoje) 

    //calculo a data que recebo 
    //descomponho a data em um array 
    var array_data = data.split("/") 
	
    //se o array nao tem tres partes, a data eh incorreta 
    if (array_data.length!=3) 
       return false 

    //comprovo que o ano, mes, dia são corretos 
    var ano 
    ano = parseInt(array_data[2]); 
    if (isNaN(ano)) 
       return false 

    var mes 
    mes = parseInt(array_data[1]); 
    if (isNaN(mes)) 
       return false 

    var dia 
    dia = parseInt(array_data[0]); 
    if (isNaN(dia)) 
       return false 
	   
    //se o ano da data que recebo so tem 2 cifras temos que muda-lo a 4 
    if (ano<=99) 
       ano +=1900 

    //subtraio os anos das duas datas 
    idade = hoje.getFullYear()- ano - 1; //-1 porque ainda nao fez anos durante este ano 
	
    //se subtraio os meses e for menor que 0 entao nao cumpriu anos. Se for maior sim ja cumpriu 
    if (hoje.getMonth() + 1 - mes < 0) //+ 1 porque os meses comecam em 0 
       document.getElementById('idade').value = idade 
    if (hoje.getMonth() + 1 - mes > 0) 
       document.getElementById('idade').value = idade+1 

    //entao eh porque sao iguais. Vejo os dias 
    //se subtraio os dias e der menor que 0 entao nao cumpriu anos. Se der maior ou igual sim que já cumpriu 
    if (hoje.getUTCDate() - dia >= 0) 
       document.getElementById('idade').value = idade + 1 

    document.getElementById('idade').value = idade = idade; 
} 
</script>